@namespace WebFrontend.Components.UI.Dialog

@* DialogProvider - renders all dialogs in a portal outside the layout *@
@inject DialogService DialogService
@implements IDisposable

@foreach (var dialog in DialogService.GetDialogs())
{
    @if (dialog.Open)
    {
        <div
            data-dialog-overlay="@dialog.DialogId"
            data-state="@(dialog.Open ? "open" : "closed")"
            class="fixed inset-0 z-50 bg-black/40"
            @onclick="() => dialog.OnClose?.Invoke()" />

        <div
            data-dialog-id="@dialog.DialogId"
            data-dialog-content="@dialog.DialogId"
            data-state="@(dialog.Open ? "open" : "closed")"
            style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 50;"
            class="z-50"
            role="dialog"
            aria-modal="true">
            @dialog.Content
        </div>
    }
}

@code {
    protected override void OnInitialized()
    {
        DialogService.OnDialogsChanged += StateHasChanged;
    }

    public void Dispose()
    {
        DialogService.OnDialogsChanged -= StateHasChanged;
    }
}
