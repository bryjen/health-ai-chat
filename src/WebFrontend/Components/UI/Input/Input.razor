@using WebFrontend.Components.UI.Shared
@namespace WebFrontend.Components.UI.Input

@* Input component with shadcn styling *@
<input
    type="@Type"
    data-slot="input"
    class="@GetClass()"
    value="@Value"
    @oninput="HandleInput"
    @onchange="HandleChange"
    disabled="@Disabled"
    placeholder="@Placeholder"
    @attributes="AdditionalAttributes" />

@code {
    [Parameter] public string? Type { get; set; } = "text";
    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter] public string Size { get; set; } = "default";
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public string? Placeholder { get; set; }
    [Parameter] public EventCallback<ChangeEventArgs> OnChange { get; set; }
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private string GetClass()
    {
        var baseClasses = "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground bg-input/30 border-input w-full min-w-0 rounded-md border bg-transparent shadow-xs transition-all duration-200 outline-none file:inline-flex file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/40 aria-invalid:border-destructive";

        var sizeClasses = Size switch
        {
            "sm" => "h-8 px-2.5 py-1 text-sm",
            "lg" => "h-10 px-3.5 py-2 text-base",
            _ => "h-9 px-3 py-1.5 text-base md:text-sm"
        };

        return ClassBuilder.Merge(baseClasses, sizeClasses, Class);
    }

    private async Task HandleInput(ChangeEventArgs e)
    {
        Value = e.Value?.ToString();
        await ValueChanged.InvokeAsync(Value);
    }

    private async Task HandleChange(ChangeEventArgs e)
    {
        await OnChange.InvokeAsync(e);
    }
}
